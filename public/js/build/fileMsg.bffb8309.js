import{m as a,n as r,_ as s}from"./app.350b47a4.js";import{I as l}from"./IFrame.5d66bca8.js";var c=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"single-file-msg"},[e("PageTitle",{attrs:{title:t.title}}),t.loadIng>0?e("Loading"):t.isWait?t._e():[t.isType("md")?e("MDPreview",{attrs:{initialValue:t.msgDetail.content.content}}):t.isType("text")?e("TEditor",{attrs:{value:t.msgDetail.content.content,height:"100%",readOnly:""}}):t.isType("drawio")?e("Drawio",{attrs:{title:t.msgDetail.msg.name,readOnly:""},model:{value:t.msgDetail.content,callback:function(n){t.$set(t.msgDetail,"content",n)},expression:"msgDetail.content"}}):t.isType("mind")?e("Minder",{attrs:{value:t.msgDetail.content,readOnly:""}}):t.isType("code")?[t.isLongText(t.msgDetail.msg.name)?e("div",{staticClass:"view-code",domProps:{innerHTML:t._s(t.$A.formatTextMsg(t.msgDetail.content.content,t.userId))}}):e("AceEditor",{staticClass:"view-editor",attrs:{ext:t.msgDetail.msg.ext,readOnly:""},model:{value:t.msgDetail.content.content,callback:function(n){t.$set(t.msgDetail.content,"content",n)},expression:"msgDetail.content.content"}})]:t.isType("office")?e("OnlyOffice",{attrs:{code:t.officeCode,documentKey:t.documentKey,readOnly:""},model:{value:t.officeContent,callback:function(n){t.officeContent=n},expression:"officeContent"}}):t.isType("preview")?e("IFrame",{staticClass:"preview-iframe",attrs:{src:t.previewUrl}}):e("div",{staticClass:"no-support"},[t._v(t._s(t.$L("\u4E0D\u652F\u6301\u5355\u72EC\u67E5\u770B\u6B64\u6D88\u606F")))])]],2)},m=[];const d=()=>s(()=>import("./preview.7b256086.js"),["js/build/preview.7b256086.js","js/build/app.350b47a4.js","js/build/app.ce302724.css"]),_=()=>s(()=>import("./TEditor.bc76d4e1.js"),["js/build/TEditor.bc76d4e1.js","js/build/app.350b47a4.js","js/build/app.ce302724.css","js/build/ImgUpload.07949915.js"]),u=()=>s(()=>import("./AceEditor.d5efc9e6.js"),["js/build/AceEditor.d5efc9e6.js","js/build/app.350b47a4.js","js/build/app.ce302724.css"]),g=()=>s(()=>import("./OnlyOffice.16c0a7a3.js"),["js/build/OnlyOffice.16c0a7a3.js","js/build/OnlyOffice.60b2a58f.css","js/build/app.350b47a4.js","js/build/app.ce302724.css","js/build/IFrame.5d66bca8.js"]),f=()=>s(()=>import("./Drawio.aef69c23.js"),["js/build/Drawio.aef69c23.js","js/build/Drawio.fc5c6326.css","js/build/app.350b47a4.js","js/build/app.ce302724.css","js/build/IFrame.5d66bca8.js"]),p=()=>s(()=>import("./Minder.d465c0d7.js"),["js/build/Minder.d465c0d7.js","js/build/Minder.3ba64342.css","js/build/IFrame.5d66bca8.js","js/build/app.350b47a4.js","js/build/app.ce302724.css"]),v={components:{IFrame:l,AceEditor:u,TEditor:_,MDPreview:d,OnlyOffice:g,Drawio:f,Minder:p},data(){return{loadIng:0,isWait:!1,msgDetail:{}}},mounted(){},watch:{$route:{handler(){this.getInfo()},immediate:!0}},computed:{...a(["userId"]),msgId(){const{msgId:t}=this.$route.params;return parseInt(/^\d+$/.test(t)?t:0)},title(){const{msg:t}=this.msgDetail;return t&&t.name?t.name:"Loading..."},isType(){const{msgDetail:t}=this;return function(i){return t.type=="file"&&t.file_mode==i}},officeContent(){return{id:this.msgDetail.id||0,type:this.msgDetail.msg.ext,name:this.title}},officeCode(){return"msgFile_"+this.msgDetail.id},previewUrl(){const{name:t,key:i}=this.msgDetail.content;return $A.apiUrl(`../online/preview/${t}?key=${i}`)}},methods:{getInfo(){this.msgId<=0||(setTimeout(t=>{this.loadIng++},600),this.isWait=!0,this.$store.dispatch("call",{url:"dialog/msg/detail",data:{msg_id:this.msgId}}).then(({data:t})=>{this.msgDetail=t}).catch(({msg:t})=>{$A.modalError({content:t,onOk:()=>{this.$Electron&&window.close()}})}).finally(t=>{this.loadIng--,this.isWait=!1}))},documentKey(){return new Promise((t,i)=>{this.$store.dispatch("call",{url:"dialog/msg/detail",data:{msg_id:this.msgId,only_update_at:"yes"}}).then(({data:e})=>{t(`${e.id}-${$A.Time(e.update_at)}`)}).catch(e=>{i(e)})})},isLongText(t){return/^LongText-/.test(t)}}},o={};var h=r(v,c,m,!1,D,null,null,null);function D(t){for(let i in o)this[i]=o[i]}var I=function(){return h.exports}();export{I as default};
